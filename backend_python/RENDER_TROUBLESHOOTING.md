# Render Deployment Troubleshooting

## Issue: ModuleNotFoundError: No module named 'your_application'

### Cause
Render is using an incorrect start command or couldn't find the correct WSGI module.

### Solution

#### Option 1: Update Start Command in Render Dashboard (Recommended)

1. Go to https://dashboard.render.com/
2. Click on your Django service
3. Go to **Settings** tab
4. Scroll to **Start Command**
5. Update to:
   ```
   gunicorn portfolio.wsgi:application --bind 0.0.0.0:$PORT
   ```
6. Click **Save Changes**
7. Service will auto-redeploy

#### Option 2: Use Procfile (Already Added)

The `Procfile` has been added to the repository. Render will automatically detect and use it.

#### Option 3: Manual Redeploy

1. Go to your service on Render
2. Click **Manual Deploy** → **Deploy latest commit**
3. Wait for build to complete

---

## Common Render Deployment Issues

### 1. Build Fails - Permission Denied on build.sh

**Error**: `Permission denied: ./build.sh`

**Solution**:
```bash
chmod +x build.sh
git add build.sh
git commit -m "Make build.sh executable"
git push
```

### 2. Database Connection Error

**Error**: `django.db.utils.OperationalError: could not connect to server`

**Solution**:
- Ensure database is created in Render
- Check `DATABASE_URL` environment variable is set
- Verify database and web service are in same region

### 3. Static Files Not Loading

**Error**: 404 on static files

**Solution**:
- Ensure `python manage.py collectstatic` runs in build.sh
- Check `STATIC_ROOT` in settings.py
- Verify WhiteNoise is installed

### 4. CORS Errors

**Error**: `Access to XMLHttpRequest blocked by CORS policy`

**Solution**:
- Add `CORS_ALLOWED_ORIGINS` environment variable
- Value should be your frontend URL (e.g., `https://your-frontend.onrender.com`)
- Include protocol (https://) and no trailing slash

### 5. Admin User Not Created

**Error**: Can't login to admin panel

**Solution**:
```bash
# Check build logs to see if setup command ran
# If not, manually create superuser:
python manage.py createsuperuser
```

Or use the management command:
```bash
python manage.py setup
```

### 6. Python Version Mismatch

**Error**: Package installation fails or import errors

**Solution**:
- Add `PYTHON_VERSION` environment variable in Render
- Value: `3.11.0` (or your preferred version)
- Or add `.python-version` file to repository

### 7. Module Not Found After Deployment

**Error**: `ModuleNotFoundError: No module named 'xyz'`

**Solution**:
- Ensure package is in `requirements.txt`
- Check package name spelling
- Verify build logs show successful installation
- Try manual redeploy

---

## Checking Logs

### View Build Logs
1. Go to Render Dashboard
2. Click your service
3. Go to **Logs** tab
4. Filter by **Build** to see build process

### View Runtime Logs
1. Same **Logs** tab
2. Filter by **Deploy** to see runtime errors
3. Look for Python tracebacks

---

## Environment Variables Checklist

Required variables:
- ✅ `DATABASE_URL` - Auto-set by Render when database connected
- ✅ `SECRET_KEY` - Auto-generated by Render
- ✅ `PYTHON_VERSION` - Set to `3.11.0`

Optional but recommended:
- ✅ `DEBUG` - Set to `False` (default)
- ✅ `ALLOWED_HOSTS` - Set to `.onrender.com`
- ✅ `CORS_ALLOWED_ORIGINS` - Your frontend URL

---

## Verify Deployment

After successful deployment, test these URLs:

1. **Root**: `https://your-service.onrender.com/`
   - Should show API info

2. **Admin**: `https://your-service.onrender.com/admin/`
   - Should show Django admin login

3. **Posts**: `https://your-service.onrender.com/posts/`
   - Should return empty array `{"status":"success","data":[]}`

4. **Health Check**: Look for "Your service is live" in Render dashboard

---

## Still Having Issues?

1. **Check Render Status**: https://status.render.com/
2. **Review Render Docs**: https://render.com/docs/deploy-django
3. **Check Build Logs**: Look for specific error messages
4. **Verify File Structure**:
   ```
   backend_python/
   ├── manage.py
   ├── portfolio/
   │   ├── settings.py
   │   ├── wsgi.py
   │   └── urls.py
   ├── core/
   ├── requirements.txt
   ├── build.sh
   └── Procfile
   ```

5. **Test Locally**:
   ```bash
   cd backend_python
   source venv/bin/activate
   python manage.py runserver
   ```

---

## Quick Fixes

### Force Rebuild
1. Go to service settings
2. Change any environment variable (add a space)
3. Save - triggers rebuild

### Clear Build Cache
1. Go to service settings
2. Scroll to **Danger Zone**
3. Click **Clear Build Cache**
4. Manual deploy

### Start Fresh
1. Delete the service on Render
2. Create new web service
3. Follow deployment steps again

---

## Contact Support

If none of these work:
- Render Support: https://render.com/support
- Include: Service name, error logs, what you've tried
